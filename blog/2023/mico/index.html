<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,n=e=>{let t=e.split(" "),n=t.slice(0,-1).join(" ");return[t.at(-1),n]},a=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(n),r=a[0][0],o=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"My submission to the MICO Challenge"),i="2023",l="October 7, 2025";{let e=a.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@article{${(r+i+o.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${o}},\n  year = {${i}},\n  note = {Accessed ${l}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> My submission to the MICO Challenge | Anshuman Suri </title> <meta name="author" content="Anshuman Suri"> <meta name="description" content="Description of my entry to the MICO challenge (co-located with SaTML) for membership inference that won me the 2nd place on the CIFAR track."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%90%BF%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://anshumansuri.com/blog/2023/mico/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <d-front-matter> <script async type="text/json">
      {
            "title": "My submission to the MICO Challenge",
            "description": "Description of my entry to the MICO challenge (co-located with SaTML) for membership inference that won me the 2nd place on the CIFAR track.",
            "published": "January 31, 2023",
            "authors": [
              
              {
                "author": "Anshuman Suri",
                "authorURL": "https://anshumansuri.com/",
                "affiliations": [
                  {
                    "name": "University of Virginia",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Anshuman</span> Suri </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks </a> </li> <li class="nav-item "> <a class="nav-link" href="/service/">service </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>My submission to the MICO Challenge</h1> <p>Description of my entry to the MICO challenge (co-located with SaTML) for membership inference that won me the 2nd place on the CIFAR track.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#features">Features</a> </div> <div> <a href="#"></a> </div> <ul> <li> <a href="#target-model-features">Target-model features</a> </li> <li> <a href="#reference-model-features">Reference-model features</a> </li> </ul> <div> <a href="#feature-inspection">Feature Inspection</a> </div> <div> <a href="#takeaways">Takeaways</a> </div> </nav> </d-contents> <p>Here I describe my approach to the <a href="https://github.com/microsoft/MICO" rel="external nofollow noopener" target="_blank">MICO challenge</a>, co-located with <a href="https://satml.org/" rel="external nofollow noopener" target="_blank">SaTML</a> 2023. Specifically, I walk through my solution for the <a href="https://codalab.lisn.upsaclay.fr/competitions/8551" rel="external nofollow noopener" target="_blank">CIFAR track</a>, which got me the <a href="https://codalab.lisn.upsaclay.fr/competitions/8551#results" rel="external nofollow noopener" target="_blank">second position on the final leaderboard</a>. I used the same approach for the Purchase100 track as well, but finished fourth. A description of all the winning approaches can be found <a href="https://microsoft.github.io/MICO/" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>Let’s start by downloading relevant data from the MICO competition, which can be found <a href="https://codalab.lisn.upsaclay.fr/competitions/8551#participate-submit_results" rel="external nofollow noopener" target="_blank">here</a> (for CIFAR).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">urllib</span>

<span class="kn">from</span> <span class="n">torchvision.datasets.utils</span> <span class="kn">import</span> <span class="n">download_and_extract_archive</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>

<span class="kn">from</span> <span class="n">mico_competition.scoring</span> <span class="kn">import</span> <span class="n">tpr_at_fpr</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">generate_roc</span><span class="p">,</span> <span class="n">generate_table</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">roc_auc_score</span>

<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">torch</span>
<span class="kn">import</span> <span class="n">csv</span>
<span class="kn">import</span> <span class="n">copy</span>

<span class="kn">from</span> <span class="n">torch.autograd</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="n">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="n">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="n">torch.distributions</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="kn">from</span> <span class="n">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="n">mico_competition</span> <span class="kn">import</span> <span class="n">ChallengeDataset</span><span class="p">,</span> <span class="n">load_cifar10</span><span class="p">,</span> <span class="n">load_model</span>
<span class="kn">from</span> <span class="n">torch.distributions</span> <span class="kn">import</span> <span class="n">Categorical</span>
<span class="kn">import</span> <span class="n">torch.nn.utils.prune</span> <span class="k">as</span> <span class="n">prune</span>

<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">matplotlib</span>
<span class="kn">import</span> <span class="n">torch</span> <span class="k">as</span> <span class="n">ch</span>
<span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>

<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="n">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="n">sklearn.inspection</span> <span class="kn">import</span> <span class="n">permutation_importance</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="n">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="n">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="kn">import</span> <span class="n">autosklearn.classification</span>
<span class="kn">import</span> <span class="n">autosklearn.metrics</span>
</code></pre></div></div> <h2 id="features">Features</h2> <h3 id="target-model-features">Target-model features</h3> <p>Let’s start by collecting features that, for a given target model, only utilize information from that model and any additional data. Later in the post, we will cover features based on utilization of other ‘reference’ model and the problem setup.</p> <p>The first feature I included is based on the approach described in <d-cite key="carlini2022membership"></d-cite> , using class-scaled logits instead of direct probabilities.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_class_scaled_logits</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">features</span><span class="p">).</span><span class="nf">detach</span><span class="p">().</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">outputs</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">item</span><span class="p">()</span>
        <span class="n">wanted</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="n">not_wanted</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">label</span><span class="p">)]</span>
        <span class="n">values</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">wanted</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">not_wanted</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div> <p>Next, I use the MERLIN<d-cite key="jayaraman2021revisiting"></d-cite> approach to sample neighbors and note variation in model loss. Modification uses log-scale while noting loss differences.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@torch.no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">relative_log_merlin</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">small_value</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="nc">CrossEntropyLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">normal</span><span class="p">.</span><span class="nc">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_preds</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
    <span class="n">base_losses</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">base_preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">).</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
    <span class="n">base_preds</span> <span class="o">=</span> <span class="n">base_preds</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">):</span>
            <span class="n">sampled_noise</span> <span class="o">=</span> <span class="n">noise</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="n">feature</span><span class="p">.</span><span class="n">shape</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">feature</span><span class="p">.</span><span class="n">device</span><span class="p">)</span>
            <span class="n">neighbors</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">feature</span> <span class="o">+</span> <span class="n">sampled_noise</span><span class="p">)</span>
            <span class="n">distances</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">sampled_noise</span><span class="p">.</span><span class="nf">mean</span><span class="p">().</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">item</span><span class="p">())</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">stack</span><span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">loss_neighbors</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model</span><span class="p">(</span><span class="n">neighbors</span><span class="p">),</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">view</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">repeat</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">))</span>
        <span class="n">loss_change</span> <span class="o">=</span> <span class="n">ch</span><span class="p">.</span><span class="nf">norm</span><span class="p">((</span><span class="n">loss_neighbors</span> <span class="o">-</span> <span class="n">base_losses</span><span class="p">[</span><span class="n">i</span><span class="p">])).</span><span class="nf">item</span><span class="p">()</span>
        <span class="c1"># Use relative drop instead of absolute
</span>        <span class="n">loss_change</span> <span class="o">/=</span> <span class="p">(</span><span class="n">small_value</span> <span class="o">+</span> <span class="n">base_losses</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">item</span><span class="p">())</span>
        <span class="n">diffs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">loss_change</span> <span class="o">+</span> <span class="n">small_value</span><span class="p">))</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
    <span class="c1"># Clip at zero (lower side)
</span>    <span class="n">diffs</span><span class="p">[</span><span class="n">diffs</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">diffs</span>
</code></pre></div></div> <p>Next, I perform gradient-descent on the given data (using the training loss) to make modifications to the input. Makes note of change in model loss after gradient ascent, as well as the change in the input itself. My intuition here was that members would have less scope for loss reduction (and consequently smaller changes to the datum itself).</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">ascent_recovery</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">adv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="nc">CrossEntropyLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">n_times</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="k">if</span> <span class="n">adv</span> <span class="k">else</span> <span class="mf">0.1</span> <span class="c1"># For normal, use higher
</span>    <span class="n">final_losses</span><span class="p">,</span> <span class="n">final_dist</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">feature_var</span> <span class="o">=</span> <span class="nc">Variable</span><span class="p">(</span><span class="n">feature</span><span class="p">.</span><span class="nf">clone</span><span class="p">().</span><span class="nf">detach</span><span class="p">(),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_times</span><span class="p">):</span>
            <span class="n">feature_var</span> <span class="o">=</span> <span class="nc">Variable</span><span class="p">(</span><span class="n">feature_var</span><span class="p">.</span><span class="nf">clone</span><span class="p">().</span><span class="nf">detach</span><span class="p">(),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature_var</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">torch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">ones_like</span><span class="p">(</span><span class="n">loss</span><span class="p">),</span> <span class="n">retain_graph</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">ch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">adv</span><span class="p">:</span>
                    <span class="n">feature_var</span><span class="p">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">feature_var</span><span class="p">.</span><span class="n">data</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">feature_var</span><span class="p">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">step_size</span> <span class="o">*</span> <span class="n">feature_var</span><span class="p">.</span><span class="n">data</span>
                <span class="n">loss_new</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature_var</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="c1"># Get reduction in loss
</span>        <span class="n">final_losses</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">loss</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span> <span class="o">-</span> <span class="n">loss_new</span><span class="p">.</span><span class="nf">item</span><span class="p">())</span>
        <span class="c1"># Get change in data (norm)
</span>        <span class="n">final_dist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">feature_var</span><span class="p">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">feature</span><span class="p">.</span><span class="n">data</span><span class="p">).</span><span class="nf">detach</span><span class="p">().</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">())</span>
    <span class="n">final_losses</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">stack</span><span class="p">((</span><span class="n">final_losses</span><span class="p">,</span> <span class="n">final_dist</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_losses</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div> <p>Next idea is to “train” model on given data to see how much loss changes. If was with DP, not seen many times (and with clipped gradient), so expected loss decrease would be much more than that for some point that has already been seen multiple times. While at it, I also take note of gradient norms</p> <div class="alert alert-info" role="alert"> I tried using the learning rates corresponding to different training mechanisms, turns out that using the same, higher LR, works out best in practice. </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extended_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">use_dp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># if use_dp else 0.0005
</span>    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">CrossEntropyLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Note losses currently
</span>    <span class="n">base_preds</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">features</span><span class="p">).</span><span class="nf">detach</span><span class="p">()</span>
    <span class="n">base_losses</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">base_preds</span><span class="p">,</span> <span class="n">labels</span><span class="p">).</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
        <span class="c1"># Make copy of model
</span>        <span class="n">model_</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">deepcopy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">model_</span><span class="p">.</span><span class="nf">train</span><span class="p">()</span>
        <span class="n">model_</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">ch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="nc">SGD</span><span class="p">(</span><span class="n">model_</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model_</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>
        <span class="c1"># Keep track of gradient norms
</span>        <span class="n">gradient_norms</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">norm</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="nf">detach</span><span class="p">().</span><span class="nf">cpu</span><span class="p">()).</span><span class="nf">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">model_</span><span class="p">.</span><span class="nf">parameters</span><span class="p">()]</span>
        <span class="c1"># Keep track of updated loss
</span>        <span class="n">loss_new</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model_</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">)).</span><span class="nf">detach</span><span class="p">().</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
        <span class="n">loss_difference</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_losses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">loss_new</span><span class="p">).</span><span class="nf">item</span><span class="p">()</span>
        <span class="n">gradient_norms</span> <span class="o">+=</span> <span class="p">[</span><span class="n">loss_difference</span><span class="p">]</span>
        <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">gradient_norms</span><span class="p">)</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">features_collected</span><span class="p">)</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="n">features_collected</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">features_collected</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Do not care about biases or loss diff
</span>    <span class="n">features_collected</span> <span class="o">=</span> <span class="n">features_collected</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
    <span class="c1"># features_collected = np.log(features_collected + 1e-10)
</span>    <span class="k">return</span> <span class="n">features_collected</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">features_collected</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p>The next feature is inspired by dataset inference<d-cite key="mainidataset"></d-cite>. It takes fixed-size steps in random directions (but same random direction) and keep track of how many steps it takes to flip classification. The main idea here is that members/non-members would have different proximity to decision boundaries and thus would have different statistics for this result.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">blind_walk</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="c1"># Track the number of steps taken until decision flips 
</span>    <span class="c1"># Walk no more than 100 steps, and try 10 different random directions
</span>    <span class="n">num_directions</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">num_max_steps</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">point_of_failure</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">((</span><span class="n">num_directions</span><span class="p">,</span> <span class="n">features</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span>
    <span class="n">std</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_directions</span><span class="p">):</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">ch</span><span class="p">.</span><span class="nf">randn_like</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">*</span> <span class="n">std</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_max_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">new_labels</span> <span class="o">=</span> <span class="n">ch</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="nf">model</span><span class="p">(</span><span class="n">features</span> <span class="o">+</span> <span class="n">noise</span> <span class="o">*</span> <span class="n">i</span><span class="p">).</span><span class="nf">detach</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">flipped</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">nonzero</span><span class="p">((</span><span class="n">new_labels</span> <span class="o">!=</span> <span class="n">labels</span><span class="p">).</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">point_of_failure</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">flipped</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">minimum</span><span class="p">(</span><span class="n">point_of_failure</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">flipped</span><span class="p">],</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">point_of_failure</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">clip</span><span class="p">(</span><span class="n">point_of_failure</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">num_max_steps</span><span class="p">)</span>
    <span class="n">point_of_failure</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">point_of_failure</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">point_of_failure</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div> <p>Now, we collect all of the features described above. Note that I also include an ‘adv’ variant for gradient-ascent that instead looks to maximize loss instead of minimizing it.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">custom_feature_collection</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">use_dp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">ascent_recovery</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">))</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">ascent_recovery</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">adv</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">extended_epoch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">use_dp</span> <span class="o">=</span> <span class="n">use_dp</span><span class="p">))</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">relative_log_merlin</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">get_class_scaled_logits</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nf">blind_walk</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">combined_feratures</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">features_collected</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combined_feratures</span>
</code></pre></div></div> <h3 id="reference-model-features">Reference-model features</h3> <p>The problem structure and distribution of data (see <a href="https://codalab.lisn.upsaclay.fr/competitions/8551#participate" rel="external nofollow noopener" target="_blank">here</a>) suggests that when looking at a given datapoint, it is more likely to have been a member of another randomly selected model, than not being a member. My intention was to somehow utilize this information in the attack.</p> <p>To compare these trends with reference models, I took inspiration from the MATT<d-cite key="sablayrolles2019white"></d-cite> attack, which works by computing gradient alignment between the given model and another reference model. Although the original attack assumes linear models (and cannot work for convolutional layers/deep models), I figured gradient similarity would still be a useful metric to compare models. For any given model, I sample 25 random reference models (out of all 100 train models) and compute gradient similarity between the given model and each reference model.</p> <p>Below, we compute gradient similarity between the given model and some reference model.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">matt_modified_scores</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">model_reference</span><span class="p">):</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">CrossEntropyLoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="sh">'</span><span class="s">none</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">cos</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">CosineSimilarity</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Make copy of model
</span>    <span class="n">model_</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">deepcopy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">model_</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">)):</span>
        <span class="c1"># Compute gradients with both models
</span>        <span class="n">model_</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">model_reference</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model_</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">loss_ref</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="nf">model_reference</span><span class="p">(</span><span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">ch</span><span class="p">.</span><span class="nf">unsqueeze</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        <span class="n">loss_ref</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        
        <span class="c1"># Compute product
</span>        <span class="n">inner_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">model_</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">model_reference</span><span class="p">.</span><span class="nf">parameters</span><span class="p">()):</span>
            <span class="n">term</span> <span class="o">=</span> <span class="n">ch</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">p1</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="nf">detach</span><span class="p">().</span><span class="nf">flatten</span><span class="p">(),</span> <span class="n">p2</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="nf">detach</span><span class="p">().</span><span class="nf">flatten</span><span class="p">()).</span><span class="nf">item</span><span class="p">()</span>
            <span class="n">inner_features</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
        <span class="n">features_collected</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">inner_features</span><span class="p">)</span>
    <span class="n">features_collected</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">features_collected</span><span class="p">)</span>
    <span class="c1"># Focus only on weight-related parameters
</span>    <span class="n">features_collected</span> <span class="o">=</span> <span class="n">features_collected</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">features_collected</span>
</code></pre></div></div> <p>To aggregate gradient alignment information across reference models (since the reference models are randomly selected, so cannot compare across models), I compute the range, mean of absolute values, min, and max of the gradient alignment scores.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">extract_features_for_reference_models</span><span class="p">(</span><span class="n">reference_features</span><span class="p">):</span>
    <span class="n">num_layers_collected</span> <span class="o">=</span> <span class="n">reference_features</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_layers_collected</span><span class="p">):</span>
        <span class="n">features</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span>
            <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">reference_features</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">reference_features</span><span class="p">[:,</span> <span class="p">:,</span>  <span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">reference_features</span><span class="p">[:,</span> <span class="p">:,</span>  <span class="n">i</span><span class="p">]),</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">np</span><span class="p">.</span><span class="nf">min</span><span class="p">(</span><span class="n">reference_features</span><span class="p">[:,</span> <span class="p">:,</span>  <span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">np</span><span class="p">.</span><span class="nf">max</span><span class="p">(</span><span class="n">reference_features</span><span class="p">[:,</span> <span class="p">:,</span>  <span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="n">T</span>
</code></pre></div></div> <p>Let’s start collecting all train models.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">collect_models</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">
        Collect all models from the </span><span class="sh">'</span><span class="s">train</span><span class="sh">'</span><span class="s"> set
    </span><span class="sh">"""</span>
    <span class="n">CHALLENGE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10</span><span class="sh">"</span>
    <span class="n">LEN_TRAINING</span> <span class="o">=</span> <span class="mi">50000</span>
    <span class="n">LEN_CHALLENGE</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">scenarios</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">)</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="nf">load_cifar10</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="sh">"</span><span class="s">/u/as9rw/work/MICO/data</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">collected_models</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:[]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">}</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="sh">"</span><span class="s">train</span><span class="sh">"</span>
    <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">scenarios</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">scenario</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model_folder</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">model</span><span class="sh">"</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">model_folder</span><span class="p">)</span>
            <span class="n">challenge_dataset</span> <span class="o">=</span> <span class="n">ChallengeDataset</span><span class="p">.</span><span class="nf">from_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">len_training</span><span class="o">=</span><span class="n">LEN_TRAINING</span><span class="p">)</span>
            <span class="n">challenge_points</span> <span class="o">=</span> <span class="n">challenge_dataset</span><span class="p">.</span><span class="nf">get_challenges</span><span class="p">()</span>
            
            <span class="n">model</span> <span class="o">=</span> <span class="nf">load_model</span><span class="p">(</span><span class="sh">'</span><span class="s">cifar10</span><span class="sh">'</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="n">collected_models</span><span class="p">[</span><span class="n">scenario</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="n">collected_models</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">collected_models</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">collected_models</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_models</span> <span class="o">=</span> <span class="nf">collect_models</span><span class="p">()</span>
</code></pre></div></div> <p>Feature vectors are thus a combination of two kinds of features. The first set (originating from <code class="language-plaintext highlighter-rouge">matt_modified_scores</code>) uses reference models and reference statistics between a given model and these reference models. The second set of features, originating from <code class="language-plaintext highlighter-rouge">custom_feature_collection</code>, does not use any additional reference models.</p> <div class="alert alert-info" role="alert"> <b>For Purchase100:</b> without the reference-model-based features, the attack had a maximum TPR@0.1FPR of $\approx0.13$, and immediately jumped to $0.15$ with the inclusion of those reference-model-based features. Additional experimentation with the meta-classifier itself bumped performance further up to $&gt;0.16$. My experience with these MI attacks has been that <b><u>the choice of meta-classifier also matters</u></b>. Most of the MI-related papers I looked at use LR-based models when dealing with features. It thus might be worthwhile to spend some time on feature engineering (using the same set of raw features) and meta-classifier optimization. </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHALLENGE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10</span><span class="sh">"</span>
<span class="n">scenarios</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">)</span>
<span class="n">phase</span> <span class="o">=</span> <span class="sh">"</span><span class="s">train</span><span class="sh">"</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="nf">load_cifar10</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="sh">"</span><span class="s">/u/as9rw/work/MICO/data</span><span class="sh">"</span><span class="p">)</span>
<span class="n">LEN_TRAINING</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">LEN_CHALLENGE</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">X_for_meta</span><span class="p">,</span> <span class="n">Y_for_meta</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">num_use_others</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># 50 worked best, but too slow
</span>
<span class="c1"># Check performance of approach on (1, n-1) models from train
</span><span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">scenarios</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">scenario</span><span class="sh">"</span><span class="p">):</span>
    <span class="n">use_dp</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">scenario</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">'</span><span class="s">_inf</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">preds_all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">scores_all</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
    <span class="n">all_except</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">model_folder</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">enumerate</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">model</span><span class="sh">"</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">model_folder</span><span class="p">)</span>
        <span class="n">challenge_dataset</span> <span class="o">=</span> <span class="n">ChallengeDataset</span><span class="p">.</span><span class="nf">from_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">len_training</span><span class="o">=</span><span class="n">LEN_TRAINING</span><span class="p">)</span>
        <span class="n">challenge_points</span> <span class="o">=</span> <span class="n">challenge_dataset</span><span class="p">.</span><span class="nf">get_challenges</span><span class="p">()</span>
        
        <span class="n">challenge_dataloader</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nc">DataLoader</span><span class="p">(</span><span class="n">challenge_points</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">LEN_CHALLENGE</span><span class="p">)</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="nf">iter</span><span class="p">(</span><span class="n">challenge_dataloader</span><span class="p">))</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="p">.</span><span class="nf">cuda</span><span class="p">(),</span> <span class="n">labels</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
            
        <span class="n">model</span> <span class="o">=</span> <span class="nf">load_model</span><span class="p">(</span><span class="sh">'</span><span class="s">cifar10</span><span class="sh">'</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="p">.</span><span class="nf">cuda</span><span class="p">(),</span> <span class="n">labels</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
        <span class="c1"># Look at all models except this one
</span>        <span class="n">other_models</span> <span class="o">=</span> <span class="n">train_models</span><span class="p">[</span><span class="n">scenario</span><span class="p">][</span><span class="n">np</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">all_except</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>
        <span class="c1"># Pick random models
</span>        <span class="n">other_models</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">other_models</span><span class="p">,</span> <span class="n">num_use_others</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">other_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other_models</span><span class="p">]</span>

        <span class="n">features_collected</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="nf">matt_modified_scores</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">other_model</span><span class="p">)</span> <span class="k">for</span> <span class="n">other_model</span> <span class="ow">in</span> <span class="n">other_models</span><span class="p">])</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="nf">extract_features_for_reference_models</span><span class="p">(</span><span class="n">features_collected</span><span class="p">)</span>
        <span class="n">other_features</span> <span class="o">=</span> <span class="nf">custom_feature_collection</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">use_dp</span> <span class="o">=</span> <span class="n">use_dp</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">scores</span><span class="p">,</span> <span class="n">other_features</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">mem_labels</span> <span class="o">=</span> <span class="n">challenge_dataset</span><span class="p">.</span><span class="nf">get_solutions</span><span class="p">()</span>

        <span class="c1"># Store
</span>        <span class="n">preds_all</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">mem_labels</span><span class="p">)</span>
        <span class="n">scores_all</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    
    <span class="n">preds_all</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">preds_all</span><span class="p">)</span>
    <span class="n">scores_all</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">scores_all</span><span class="p">)</span>
    
    <span class="n">X_for_meta</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_all</span>
    <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds_all</span>
</code></pre></div></div> <p>Use <a href="https://automl.github.io/auto-sklearn/master/" rel="external nofollow noopener" target="_blank">auto-sklearn</a> (an automl package does does pipeline, optimizer, and hyper-param optimization for you) worked out best, second to using random-forest classifiers.</p> <div class="alert alert-info" role="alert"> In all scenarios, training classifiers separately for the different scenarios (no, low, high DP) worked better than training a single classifier, even when the scenario is explicitly provided as an input feature (one-hot encoding). </div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Train different meta-classifiers per scenario
</span><span class="n">CHALLENGE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10</span><span class="sh">"</span>
<span class="n">scenarios</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">)</span>
<span class="n">meta_clfs</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">autosklearn</span><span class="p">.</span><span class="n">classification</span><span class="p">.</span><span class="nc">AutoSklearnClassifier</span><span class="p">(</span><span class="n">memory_limit</span><span class="o">=</span><span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">time_left_for_this_task</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">autosklearn</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">roc_auc</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">X_for_meta</span><span class="p">.</span><span class="nf">keys</span><span class="p">())}</span>

<span class="n">avg</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">use_all</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
    <span class="n">train_split_og</span><span class="p">,</span> <span class="n">test_split_og</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">train_split</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train_split_og</span><span class="p">])</span>
    <span class="n">test_split</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">+</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_split_og</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">use_all</span><span class="p">:</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span>
        <span class="n">X_test</span>  <span class="o">=</span> <span class="n">X_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span>
        <span class="n">y_test</span>  <span class="o">=</span> <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">][</span><span class="n">train_split</span><span class="p">]</span>
        <span class="n">X_test</span>  <span class="o">=</span> <span class="n">X_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">][</span><span class="n">test_split</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">][</span><span class="n">train_split</span><span class="p">]</span>
        <span class="n">y_test</span>  <span class="o">=</span> <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">sc</span><span class="p">][</span><span class="n">test_split</span><span class="p">]</span>

    <span class="n">meta_clfs</span><span class="p">[</span><span class="n">sc</span><span class="p">].</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">meta_clfs</span><span class="p">[</span><span class="n">sc</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">preds_train</span> <span class="o">=</span> <span class="n">meta_clfs</span><span class="p">[</span><span class="n">sc</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">sc</span><span class="si">}</span><span class="s"> AUC (train): </span><span class="si">{</span><span class="nf">roc_auc_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">preds_train</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="nf">score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="sh">'</span><span class="s">fpr</span><span class="sh">'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="sh">'</span><span class="s">tpr</span><span class="sh">'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="nf">display</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">([</span><span class="n">scores</span><span class="p">]))</span>
    <span class="n">avg</span> <span class="o">+=</span> <span class="n">scores</span><span class="p">[</span><span class="sh">'</span><span class="s">TPR_FPR_1000</span><span class="sh">'</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Average score</span><span class="sh">"</span><span class="p">,</span> <span class="n">avg</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></div> <p>For submissions, I set <code class="language-plaintext highlighter-rouge">use_all</code> to True (since the autoML classifier already does train-val splits internally). The train-test split above is just for visualization purposes (and to see how well the classifier performs on val data).</p> <h2 id="feature-inspection">Feature Inspection</h2> <p>A closer look (via permutation importance) at the features shows some interesting trends.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.inspection</span> <span class="kn">import</span> <span class="n">plot_partial_dependence</span><span class="p">,</span> <span class="n">permutation_importance</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">range_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">abssum_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">min_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">max_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">ascent_loss</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">ascent_diff</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">adv_ascent_loss</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">adv_ascent_diff</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">ext_epo_1</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">ext_epo_2</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">ext_epo_3</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">merlin</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">lira</span><span class="sh">"</span><span class="p">)</span>
<span class="n">labels</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">blindwalk</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">scenario</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10_inf</span><span class="sh">"</span>
<span class="n">r</span> <span class="o">=</span> <span class="nf">permutation_importance</span><span class="p">(</span><span class="n">meta_clfs</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span> <span class="n">X_for_meta</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span> <span class="n">Y_for_meta</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sort_idx</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">importances_mean</span><span class="p">.</span><span class="nf">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">boxplot</span><span class="p">(</span>
    <span class="n">r</span><span class="p">.</span><span class="n">importances</span><span class="p">[</span><span class="n">sort_idx</span><span class="p">].</span><span class="n">T</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sort_idx</span><span class="p">]</span>
<span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sort_idx</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="nf">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">] </span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="mi">10</span><span class="n">s</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">r</span><span class="p">.</span><span class="n">importances_mean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s"> +/- </span><span class="sh">"</span>
        <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">r</span><span class="p">.</span><span class="n">importances_std</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span>
    <span class="p">)</span>
</code></pre></div></div> <p>The abs-sum and range of gradient alignment values across reference models seem to be most useful. Features like LiRA and gradient norms in the extended-epoch simulation also seem to be important for the case of no DP.</p> <p><img src="assets/img/mico/cifar10_inf.png" alt="png"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
[20] ext_epo_1 : 0.010 +/- 0.001
[0] range_1   : 0.013 +/- 0.001
[15] max_4     : 0.016 +/- 0.003
[13] abssum_4  : 0.026 +/- 0.003
[5] abssum_2  : 0.028 +/- 0.003
[24] lira      : 0.045 +/- 0.002
[9] abssum_3  : 0.047 +/- 0.003
[21] ext_epo_2 : 0.054 +/- 0.003
[22] ext_epo_3 : 0.064 +/- 0.003
</code></pre></div></div> <p>However, the same trend does not hold when looking at models with DP.</p> <p><img src="assets/img/mico/cifar10_hi.png" alt="png"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
[22] ext_epo_3 : 0.018 +/- 0.002
[1] abssum_1  : 0.020 +/- 0.003
[12] range_4   : 0.020 +/- 0.003
[0] range_1   : 0.020 +/- 0.002
[13] abssum_4  : 0.023 +/- 0.003
[5] abssum_2  : 0.024 +/- 0.003
[9] abssum_3  : 0.027 +/- 0.002
[24] lira      : 0.053 +/- 0.003
</code></pre></div></div> <p>In this case, most of the classifier’s performance seems to originate from LiRA, followed by features extracted from reference models. However, features like the one extracted from the extended-epoch simulation seem to be less somewhat important - in fact, more than they are in the case of no DP.</p> <p>Interestingly, for the case of low-$\epsilon$ DP, merlin-based features turn out to be the most important.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/mico/cifar10_lo-480.webp 480w,/assets/img/mico/cifar10_lo-800.webp 800w,/assets/img/mico/cifar10_lo-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/mico/cifar10_lo.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><img src="assets/img/mico/cifar10_lo.png" alt="png"></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
[15] max_4     : 0.012 +/- 0.002
[1] abssum_1  : 0.014 +/- 0.003
[14] min_4     : 0.014 +/- 0.002
[24] lira      : 0.016 +/- 0.002
[8] range_3   : 0.017 +/- 0.003
[20] ext_epo_1 : 0.027 +/- 0.004
[23] merlin    : 0.028 +/- 0.002
</code></pre></div></div> <p>The utility of each of these features, though, is significantly lower than scenarios with higher-$\epsilon$ DP, or no DP at all. This is understandable, since the DP is very much intended to reduce membership inference risk. However, it is interesting that the relative utility of features is not same across the scenarios, further showing why having individual meta-classifiers for the scenarios is useful.</p> <hr> <p>Next, we collect features for all models across scenarios and phases. Helps to re-use features when experiment with different meta-classifiers. No need to re-run for ‘train’ models, since we already have features for those.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHALLENGE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10</span><span class="sh">"</span>
<span class="n">LEN_TRAINING</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">LEN_CHALLENGE</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">scenarios</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">)</span>
<span class="n">phases</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">dev</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">final</span><span class="sh">'</span><span class="p">]</span>
<span class="n">stored_features</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="nf">load_cifar10</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="sh">"</span><span class="s">/u/as9rw/work/MICO/data</span><span class="sh">"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">enumerate</span><span class="p">(</span><span class="n">scenarios</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">scenario</span><span class="sh">"</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">use_dp</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">scenario</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">'</span><span class="s">_inf</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">stored_features</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">phase</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">stored_features</span><span class="p">[</span><span class="n">scenario</span><span class="p">][</span><span class="n">phase</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">all_except</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">model_folder</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">enumerate</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">model</span><span class="sh">"</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">))):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">model_folder</span><span class="p">)</span>
            <span class="n">challenge_dataset</span> <span class="o">=</span> <span class="n">ChallengeDataset</span><span class="p">.</span><span class="nf">from_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">len_training</span><span class="o">=</span><span class="n">LEN_TRAINING</span><span class="p">)</span>
            <span class="n">challenge_points</span> <span class="o">=</span> <span class="n">challenge_dataset</span><span class="p">.</span><span class="nf">get_challenges</span><span class="p">()</span>
            
            <span class="n">model</span> <span class="o">=</span> <span class="nf">load_model</span><span class="p">(</span><span class="sh">'</span><span class="s">cifar10</span><span class="sh">'</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="n">challenge_dataloader</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nc">DataLoader</span><span class="p">(</span><span class="n">challenge_points</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">LEN_CHALLENGE</span><span class="p">)</span>
            <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">next</span><span class="p">(</span><span class="nf">iter</span><span class="p">(</span><span class="n">challenge_dataloader</span><span class="p">))</span>

            <span class="n">model</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
            <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="p">.</span><span class="nf">cuda</span><span class="p">(),</span> <span class="n">labels</span><span class="p">.</span><span class="nf">cuda</span><span class="p">()</span>
            <span class="c1"># Look at all models except this one
</span>            <span class="n">other_models</span> <span class="o">=</span> <span class="n">train_models</span><span class="p">[</span><span class="n">scenario</span><span class="p">][</span><span class="n">np</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">all_except</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span>
            <span class="n">other_models</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">other_models</span><span class="p">,</span> <span class="n">num_use_others</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">features_collected</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="nf">matt_modified_scores</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">other_model</span><span class="p">.</span><span class="nf">cuda</span><span class="p">())</span> <span class="k">for</span> <span class="n">other_model</span> <span class="ow">in</span> <span class="n">other_models</span><span class="p">])</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="nf">extract_features_for_reference_models</span><span class="p">(</span><span class="n">features_collected</span><span class="p">)</span>
            <span class="n">other_features</span> <span class="o">=</span> <span class="nf">custom_feature_collection</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">use_dp</span><span class="o">=</span><span class="n">use_dp</span><span class="p">)</span>
            <span class="n">processed_features</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">((</span><span class="n">scores</span><span class="p">,</span> <span class="n">other_features</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">stored_features</span><span class="p">[</span><span class="n">scenario</span><span class="p">][</span><span class="n">phase</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">processed_features</span><span class="p">)</span>
</code></pre></div></div> <p>Time to generate predictions!</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHALLENGE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">cifar10</span><span class="sh">"</span>
<span class="n">LEN_TRAINING</span> <span class="o">=</span> <span class="mi">50000</span>
<span class="n">LEN_CHALLENGE</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">scenarios</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">)</span>
<span class="n">phases</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">dev</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">final</span><span class="sh">'</span><span class="p">]</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="nf">load_cifar10</span><span class="p">(</span><span class="n">dataset_dir</span><span class="o">=</span><span class="sh">"</span><span class="s">/u/as9rw/work/MICO/data</span><span class="sh">"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">enumerate</span><span class="p">(</span><span class="n">scenarios</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">scenario</span><span class="sh">"</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">phase</span><span class="sh">"</span><span class="p">):</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">model_folder</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">model</span><span class="sh">"</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">model_folder</span><span class="p">)</span>
            <span class="n">features_use</span> <span class="o">=</span> <span class="n">stored_features</span><span class="p">[</span><span class="n">scenario</span><span class="p">][</span><span class="n">phase</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="c1"># Using scenario-wise meta-classifier
</span>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">meta_clfs</span><span class="p">[</span><span class="n">scenario</span><span class="p">].</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">features_use</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">assert</span> <span class="n">np</span><span class="p">.</span><span class="nf">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">predictions</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>

            <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sh">"</span><span class="s">prediction.csv</span><span class="sh">"</span><span class="p">),</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                 <span class="n">csv</span><span class="p">.</span><span class="nf">writer</span><span class="p">(</span><span class="n">f</span><span class="p">).</span><span class="nf">writerow</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</code></pre></div></div> <p>Packaging the submission: now we can store the predictions into a zip file, which you can submit to CodaLab.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">zipfile</span>

<span class="n">phases</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">dev</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">final</span><span class="sh">'</span><span class="p">]</span>
<span class="n">experiment_name</span> <span class="o">=</span> <span class="sh">"</span><span class="s">final_submission</span><span class="sh">"</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="p">.</span><span class="nc">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">submissions_cifar/</span><span class="si">{</span><span class="n">experiment_name</span><span class="si">}</span><span class="s">.zip</span><span class="sh">"</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipf</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">scenarios</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">scenario</span><span class="sh">"</span><span class="p">):</span> 
        <span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="n">phases</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">phase</span><span class="sh">"</span><span class="p">):</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">CHALLENGE</span><span class="p">,</span> <span class="n">scenario</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">model_folder</span> <span class="ow">in</span> <span class="nf">tqdm</span><span class="p">(</span><span class="nf">sorted</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">root</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">desc</span><span class="o">=</span><span class="sh">"</span><span class="s">model</span><span class="sh">"</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">model_folder</span><span class="p">)</span>
                <span class="nb">file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sh">"</span><span class="s">prediction.csv</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
                    <span class="n">zipf</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="nc">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">`prediction.csv` not found in </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s">. You need to provide predictions for all challenges</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <h2 id="takeaways">Takeaways</h2> <p>This was my first stint with actively developing and launching a membership inference attack, and I definitely learned a lot! I can now see that membership inference is <strong>hard</strong>, even when access to a highly-overlapping dataset (and models trained on similar data) are provided. I also learned that while using observation-based features directly (such as LiRA, scaled to the $[0, 1]$ scale) is commonpractice in MI literature, switching to better classifiers than linear regression (better yet- automating the entire model pipeline) can give non-trivial boosts in performance. I hope this post was helpful to you, and I’d love to hear your thoughts and feedback!</p> <p>My solutions (for both CIFAR and Purchase100) are available here: <a href="https://github.com/iamgroot42/MICO" rel="external nofollow noopener" target="_blank">https://github.com/iamgroot42/MICO</a></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/combined.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, you can cite this post as <pre id="bibtex-box">
          PLACEHOLDER FOR BIBTEX
        </pre> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Anshuman Suri. Last updated: October 07, 2025. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-publications",title:"publications",description:"",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-news",title:"news",description:"",section:"Navigation",handler:()=>{window.location.href="/news/"}},{id:"nav-talks",title:"talks",description:"",section:"Navigation",handler:()=>{window.location.href="/talks/"}},{id:"nav-service",title:"service",description:"",section:"Navigation",handler:()=>{window.location.href="/service/"}},{id:"post-advice-for-working-on-ml-projects",title:"Advice for working on ML projects",description:"Lessons and recommendations based on my experiences working on ML projects.",section:"Posts",handler:()=>{window.location.href="/blog/2025/ml-considerations/"}},{id:"post-reassessing-emnlp-2024-s-best-paper-does-divergence-based-calibration-for-membership-inference-attacks-hold-up",title:"Reassessing EMNLP 2024\u2019s Best Paper: Does Divergence-Based Calibration for Membership Inference Attacks Hold...",description:"TL;DR: No. A critical analysis of the EMNLP Best Paper proposing a divergence-based calibration for Membership Inference Attacks (MIAs). We explore its experimental shortcomings, issues with temporally shifted benchmarks, and what this means for machine learning awards.",section:"Posts",handler:()=>{window.location.href="/blog/2024/calibrated-mia/"}},{id:"post-my-submission-to-the-eti-challenge",title:"My submission to the ETI Challenge",description:"Description of my entry to the ETI (Erasing the Invisible) challenge (co-located with NeurIPS) for watermark-removal.",section:"Posts",handler:()=>{window.location.href="/blog/2024/eti-submission/"}},{id:"post-my-submission-to-the-tdc-trojan-detection-challenge",title:"My submission to the TDC Trojan Detection Challenge",description:"Description of my entry to the TDC Trojan Detection challenge (co-located with NeurIPS 2023).",section:"Posts",handler:()=>{window.location.href="/blog/2023/tdc/"}},{id:"post-my-submission-to-the-mico-challenge",title:"My submission to the MICO Challenge",description:"Description of my entry to the MICO challenge (co-located with SaTML) for membership inference that won me the 2nd place on the CIFAR track.",section:"Posts",handler:()=>{window.location.href="/blog/2023/mico/"}},{id:"post-dissecting-distribution-inference",title:"Dissecting Distribution Inference",description:"Describing our work on distribution inference attacks.",section:"Posts",handler:()=>{window.location.href="/blog/2022/ddi/"}},{id:"post-running-scripts-on-rivanna-at-uva",title:"Running scripts on Rivanna at UVA",description:"A tutorial on how to run scripts on Rivanna (SLURM in general) cluster at UVA, along with some tricks.",section:"Posts",handler:()=>{window.location.href="/blog/2022/uva-rivanna/"}},{id:"post-on-the-risks-of-distribution-inference",title:"On the Risks of Distribution Inference",description:"A blog post describing our work on Property Inference attacks.",section:"Posts",handler:()=>{window.location.href="/blog/2021/distr-inf/"}},{id:"post-reassessing-adversarial-training-with-fixed-data-augmentation",title:"Reassessing adversarial training with fixed data augmentation",description:"A recent bug discovery on Pytorch+Numpy got me thinking- how much does this bug impact adversarial robustness?",section:"Posts",handler:()=>{window.location.href="/blog/2021/advrob-aug/"}},{id:"news-passed-my-phd-dissertation-proposal-grin",title:'Passed my PhD Dissertation Proposal <img class="emoji" title=":grin:" alt=":grin:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f601.png" height="20" width="20">',description:"",section:"News"},{id:"news-runner-up-https-microsoft-github-io-mico-for-the-mico-challenge-cifar-track-co-located-with-satml-tada-i-describe-my-approach-here-blog-2023-mico",title:'[Runner-up](https://microsoft.github.io/MICO/) for the MICO challenge (CIFAR track), co-located with SaTML <img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20"> I describe...',description:"",section:"News"},{id:"news-placard-presented-our-work-on-dissecting-distribution-inference-https-arxiv-org-pdf-2212-07591-at-satml-in-raleigh-us",title:'<img class="emoji" title=":placard:" alt=":placard:" src="https://github.githubassets.com/images/icons/emoji/unicode/1faa7.png" height="20" width="20"> Presented our work on [Dissecting Distribution Inference](https://arxiv.org/pdf/2212.07591) at SaTML in Raleigh! <img class="emoji" title=":us:" alt=":us:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f1fa-1f1f8.png" height="20" width="20">...',description:"",section:"News"},{id:"news-received-the-john-a-stankovic-graduate-research-award-https-engineering-virginia-edu-department-computer-science-blogs-cs-department-end-year-award-recipients-2022-2023-from-the-cs-deparment-at-uva-for-excellence-in-research-during-the-2022-2023-academic-year",title:"Received the [John A. Stankovic Graduate Research Award](https://engineering.virginia.edu/department/computer-science/blogs/cs-department-end-year-award-recipients-2022-2023) from the CS deparment at...",description:"",section:"News"},{id:"news-leading-a-reading-group-books-on-causal-learning-https-iamgroot42-github-io-causal-reading-group-23-this-summer-at-uva-along-with-hannah-chen-https-hannahxchen-github-io",title:'Leading a reading group <img class="emoji" title=":books:" alt=":books:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4da.png" height="20" width="20"> on [Causal Learning](https://iamgroot42.github.io/causal-reading-group-23/) this summer at UVA, along...',description:"",section:"News"},{id:"news-received-the-endowed-graduate-fellowship-https-www-linkedin-com-posts-activity-7122237223894192128-shmf-utm-source-share-amp-utm-medium-member-desktop-from-the-school-of-engineering-and-applied-sciences-seas-at-uva-for-2023-24-tada",title:"Received the [Endowed Graduate Fellowship](https://www.linkedin.com/posts/activity-7122237223894192128-SHMF?utm_source=share&utm_medium=member_desktop) from the School of Engineering and Applied Sciences...",description:"",section:"News"},{id:"news-placard-presented-our-work-sok-pitfalls-in-evaluating-black-box-attacks-https-arxiv-org-pdf-2310-17534-pdf-at-satml-in-toronto-canada",title:'<img class="emoji" title=":placard:" alt=":placard:" src="https://github.githubassets.com/images/icons/emoji/unicode/1faa7.png" height="20" width="20"> Presented our work [SoK: Pitfalls in Evaluating Black-Box Attacks](https://arxiv.org/pdf/2310.17534.pdf) at SaTML in...',description:"",section:"News"},{id:"news-ph-done-say-hello-to-dr-suri",title:"Ph-Done! Say hello to Dr. Suri",description:"",section:"News",handler:()=>{window.location.href="/news/ph_done/"}},{id:"news-xiao-https-xiao-zhang-net-presented-our-work-do-parameters-reveal-more-than-loss-for-membership-inference-https-arxiv-org-pdf-2406-11544-at-the-hild-workshop-at-icml-https-sites-google-com-view-hidimlearning-home-in-vienna-austria",title:"[Xiao](https://xiao-zhang.net/) presented our work [Do Parameters Reveal More than Loss for Membership Inference](https://arxiv.org/pdf/2406.11544)...",description:"",section:"News"},{id:"news-started-as-a-postdoc-at-khoury-northeastern-supervised-by-alina-oprea-https-www-khoury-northeastern-edu-home-alina-hello-boston-cityscape",title:"Started as a postdoc at Khoury, Northeastern supervised by [Alina Oprea](https://www.khoury.northeastern.edu/home/alina/). Hello, Boston...",description:"",section:"News"},{id:"news-placard-presented-our-work-do-membership-inference-attacks-work-on-large-language-models-https-arxiv-org-pdf-2402-07841-at-colm-https-colmweb-org-cfp-html-in-philadelphia-sunny",title:'<img class="emoji" title=":placard:" alt=":placard:" src="https://github.githubassets.com/images/icons/emoji/unicode/1faa7.png" height="20" width="20"> Presented our work [Do Membership Inference Attacks Work on Large Language Models?](https://arxiv.org/pdf/2402.07841)...',description:"",section:"News"},{id:"news-scroll-my-first-patent-https-patents-google-com-patent-us12130929b2-was-just-issued-this-is-based-on-work-https-arxiv-org-pdf-2206-03317-that-our-team-did-during-my-internship-at-oracle-research-back-in-fall-2021-patents-sure-are-slow",title:'<img class="emoji" title=":scroll:" alt=":scroll:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dc.png" height="20" width="20"> My first [patent](https://patents.google.com/patent/US12130929B2/) was just issued! This is based on [work](https://arxiv.org/pdf/2206.03317) that...',description:"",section:"News"},{id:"news-newspaper-uva-engineering-covered-a-story-https-engineering-virginia-edu-news-events-news-common-way-test-leaks-large-language-models-may-be-flawed-on-our-work-on-evaluating-membership-inference-attacks-on-large-language-models-https-arxiv-org-pdf-2402-07841",title:'<img class="emoji" title=":newspaper:" alt=":newspaper:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4f0.png" height="20" width="20"> UVA Engineering [covered a story](https://engineering.virginia.edu/news-events/news/common-way-test-leaks-large-language-models-may-be-flawed) on our work on evaluating [Membership Inference...',description:"",section:"News"},{id:"news-our-blogpost-blog-2024-calibrated-mia-talking-about-critical-flaws-in-the-evaluation-of-a-recent-emnlp-best-paper-https-x-com-emnlpmeeting-status-1857176180128198695-has-been-accepted-to-the-iclr-blogpost-track",title:"Our [blogpost](blog/2024/calibrated-mia/) talking about critical flaws in the evaluation of a recent [EMNLP...",description:"",section:"News"},{id:"news-awarded-lambda-research-grant-to-work-on-training-time-poisoning-defenses-for-llms-thank-you-lambda-moneybag",title:"Awarded Lambda Research Grant to work on training-time poisoning defenses for LLMs. Thank...",description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"talks-bust-in-silhouette-project-personality-chat-intelligent-cloud-conference",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Project Personality Chat. Intelligent Cloud Conference.',description:"",section:"Talks"},{id:"talks-computer-when-models-learn-too-much-inference-privacy-in-theory-and-practice-with-david-evans-microsoft-security-data-science-colloquium",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> When Models Learn Too Much: Inference Privacy in Theory and Practice (with...',description:"",section:"Talks"},{id:"talks-computer-formalizing-distribution-inference-risks-lockheed-martin",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Formalizing Distribution Inference Risks: Lockheed Martin.',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-privacy-in-genomics-https-computingbiology-github-io-s22-class18-cs4501-computational-biology-biological-computing",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> [Privacy in Genomics](https://computingbiology.github.io/s22/class18/). CS4501: Computational Biology / Biological Computing',description:"",section:"Talks"},{id:"talks-computer-distribution-inference-university-of-melbourne",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Distribution Inference. University of Melbourne.',description:"",section:"Talks"},{id:"talks-computer-formalizing-and-estimating-distribution-inference-risks-iiith",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Formalizing and Estimating Distribution Inference Risks: IIITH.',description:"",section:"Talks"},{id:"talks-computer-distribution-inference-new-perspectives-in-data-privacy-cs562-advanced-topics-in-security-privacy-and-machine-learning-uiuc-https-chandrasekaran-group-github-io-courses-cs562-home",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Distribution Inference: New Perspectives in Data Privacy. [CS562 Advanced Topics in Security,...',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-distribution-inference-new-perspectives-in-data-privacy-princeton-https-ece-princeton-edu-events-distribution-inference-new-perspectives-data-privacy",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Distribution Inference: New Perspectives in Data Privacy. [Princeton](https://ece.princeton.edu/events/distribution-inference-new-perspectives-data-privacy).',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-distribution-inference-new-perspectives-in-data-privacy-uva-aiml-seminar-https-uvaml-github-io-pasttalks-2024-02-28",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Distribution Inference: New Perspectives in Data Privacy. [UVA AIML Seminar](https://uvaml.github.io/pasttalks/2024-02-28/).',description:"",section:"Talks"},{id:"talks-computer-do-membership-inference-attacks-work-on-large-language-models-https-drive-google-com-file-d-1vkahsahwkmy4psti7f4k0z26gfakxrv2-view-cohere-for-ai",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> [Do Membership Inference Attacks Work on Large Language Models?](https://drive.google.com/file/d/1vKAHsahwKmy4PsTi7f4K0Z26gfAkXRV2/view) Cohere for AI....',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-do-membership-inference-attacks-work-on-large-language-models-google-research",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Do Membership Inference Attacks Work on Large Language Models? Google Research.',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-do-membership-inference-attacks-work-on-large-language-models-university-of-washington",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Do Membership Inference Attacks Work on Large Language Models? University of Washington....',description:"",section:"Talks"},{id:"talks-computer-do-membership-inference-attacks-work-on-large-language-models-safr-ai-lab-https-sethneel-com-safr-ai-lab-harvard-university",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Do Membership Inference Attacks Work on Large Language Models? [SAFR AI Lab](https://sethneel.com/safr-ai-lab/),...',description:"",section:"Talks"},{id:"talks-computer-do-membership-inference-attacks-work-on-large-language-models-privacy-team-cas-meta-https-research-facebook-com-teams-cas",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Do Membership Inference Attacks Work on Large Language Models? [Privacy Team, CAS,...',description:"",section:"Talks"},{id:"talks-computer-distribution-inference-new-perspectives-in-data-privacy-vector-institute",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Distribution Inference: New Perspectives in Data Privacy. Vector Institute.',description:"",section:"Talks"},{id:"talks-computer-white-box-v-s-black-box-privacy-auditing-for-machine-learning-ai-security-and-privacy-umass-ahmerst-https-aisec-cs-umass-edu",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> White-box v/s Black-box: Privacy Auditing for Machine Learning. [AI Security and Privacy,...',description:"",section:"Talks"},{id:"talks-computer-stealthy-membership-inference-for-retrieval-augmented-generation-fair-ml-university-of-south-florida-https-www-anshumanc-com",title:'<img class="emoji" title=":computer:" alt=":computer:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png" height="20" width="20"> Stealthy Membership Inference for Retrieval-Augmented Generation. [Fair ML, University of South Florida](https://www.anshumanc.com/)....',description:"",section:"Talks"},{id:"talks-bust-in-silhouette-tools-and-agents-cy-4100-machine-learning-security-and-privacy-northeastern-university-https-www-ccs-neu-edu-home-alina-classes-fall2025",title:'<img class="emoji" title=":bust_in_silhouette:" alt=":bust_in_silhouette:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f464.png" height="20" width="20"> Tools and Agents. [CY 4100: Machine Learning Security and Privacy, Northeastern University](https://www.ccs.neu.edu/home/alina/classes/Fall2025/)....',description:"",section:"Talks"},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%61%6E%73.%73%75%72%69@%6E%6F%72%74%68%65%61%73%74%65%72%6E.%65%64%75","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=JDp__3wAAAAJ","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/iamgroot42","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/iamgroot42","_blank")}},{id:"socials-x",title:"X",description:"Twitter",section:"Socials",handler:()=>{window.open("https://twitter.com/iamgroot42","_blank")}},{id:"socials-bluesky",title:"Bluesky",section:"Socials",handler:()=>{window.open("https://bsky.app/profile/iamgroot42.bsky.social","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>